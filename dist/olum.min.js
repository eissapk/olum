/**
* @name Olum.js
* @version 0.2.2
* @copyright 2021
* @author Eissa Saber
* @license MIT
*/
!function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Olum=t()}("undefined"!=typeof self?self:this,function(){"use strict";var n="undefined"!=typeof self?self:this,m="Olum [warn]:",o=!1;function u(){return-1!==["localhost","127.0.0.1"].indexOf(n.location.hostname)}function f(e){return null!==e&&"object"==typeof e}function d(e){return f(e)&&Array.isArray(e)&&e.length}function h(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}function y(e,t){t="err"==(t=null==t?"log":t)?"error":t,o&&(Array.isArray(e)?console[t].apply(console,e):console[t](e))}return String.prototype.cap=function(){return this.toLowerCase().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" ")},function e(t){if(!(this instanceof e))throw new Error("can't invoke 'Olum' without 'new' keyword");var c=null,p=null,o=null,s=t&&t.prefix?t.prefix:null;function r(e){var l=[];return function e(t){if(t.hasOwnProperty("components")&&f(r=t.components)&&Array.isArray(Object.keys(r))&&Object.keys(r).length)for(var n in t.components){var o={};h(o,"parent",t.name),h(o,"child",{}),h(o.child,"name",n),n=new t.components[n],h(o.child,"olumCompData",n.olumCompData()),l.push(o),o.hasOwnProperty("child")&&o.child.hasOwnProperty("olumCompData")&&e(o.child.olumCompData)}var r}(e),l}function l(e){var t="olum_style_tag",n=document.getElementById(t);n||((n=document.createElement("style")).id=t,document.head.append(n)),n.innerHTML=e+"\n [to] * {pointer-events: none;}"}function a(e){var t=e.entry,n=e.compsArr,o=t.template||"",r=t.style||"",l={};if(t.render&&(l[0]=t.render),d(n))for(var a=0;a<n.length;a++){var i=(c=n[a].child.olumCompData).template||"",m=c.style||"",u=c.render||null,c=s?s+"-"+c.name:c.name,c=new RegExp("<("+c+"\\s{0,})\\/>","gi"),o=o.replace(c,i);r+=m,null!==u&&(l[a+1]=u)}return{template:o,style:r,script:l}}function i(e,t){for(var n=/(olum-component=[\"\']([^\"|\']*)[\"\'])|(olum-component)/gi,o=/<[a-z]+(>|.*?[^?]>)/gi,r=/\>/gi,l=Array.from(t),e=e,a=0;a<l.length;a++){var i,m,u=l[a].child.olumCompData.name||"undefined";l[a].child&&l[a].child.olumCompData&&l[a].child.olumCompData.hasOwnProperty("template")&&((i=l[a].child.olumCompData).template=i.template.replace(n,""),d(m=i.template.match(o))&&(i.template=i.template.replace(m[0],m[0].replace(r," olum-component='"+u+"'>"))))}return e.template&&(u=e.name||"undefined",e.template=e.template.replace(n,""),d(m=e.template.match(o))&&(e.template=e.template.replace(m[0],m[0].replace(r," olum-component='"+u+"' router-view='"+u+"'>")))),c.setAttribute("olum-component",p),{entry:e,compsArr:l}}this.use=function(e){if(!e)throw new Error(m+" Missing component or router @use()");if(!(o=e.name&&"function"==typeof e.name&&"OlumRouter"===e.name()?{type:"router",cb:e}:{type:"component",cb:e}))throw new Error(m+" Root component or router are not defined!");!function(){if(!c)throw new Error(m+" Root Element is not found in DOM!");!function(){if(y({mount:"mount()",rootElm:c,which:o}),!(o&&o.type&&o.cb))throw new Error(m+" Can't mount, Missing component or router @use()");"router"===o.type?function(){y("use OlumRouter");var e=o.cb;e.__proto__.rootElm=c,e.__proto__.buildStyles=l,e.__proto__.buildTree=r,e.__proto__.labelView=i,e.__proto__.merge=a,e.isReady&&e.listen()}():"component"===o.type&&function(){y("use component");var e=(new o.cb).olumCompData(),t=r(e),n=a(u()?i(e,t):{entry:e,compsArr:t});l(n.style),c.innerHTML=n.template,setTimeout(function(){for(var e in n.script)n.script[e]()},0)}()}()}()},this.$=function(e){if(!e)throw new Error(m+" Root Element is not found in DOM!");var t;return-1!==e.indexOf(".")?t=".":-1!==e.indexOf("#")&&(t="#"),u()&&(p=e.replace(/\#|\./,"").cap(),n.olumDevtool={rootCompName:p,selector:e}),e=e.replace(/\#|\./,""),c="."===t?document.getElementsByClassName(e)[0]:"#"===t?document.getElementById(e):document.getElementsByTagName(e)[0],this}}});